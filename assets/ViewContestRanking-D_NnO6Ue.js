import{d as $,P as S,c as E,r as b,O as V,Q as L,a,l as x,b as s,F as d,k as p,e as _,E as M,ab as P,a3 as I,o as l,j as f,n as v,q as C,t as c,i as O,ac as T,_ as B,aa as A,ad as F,K,M as q}from"./index-DAcFLkXI.js";const z={class:"ranklist-container"},D={key:0,class:"ranklist"},Q={class:"colgroup"},G={class:"col-problem"},H={class:"headline"},J={class:"problem-cell"},U={class:"normal-line"},W={class:"rank"},X={class:"name"},Y={class:"score-solved"},Z={class:"score-penalty"},tt={class:"result-cell"},st=$({__name:"RankList",setup(g){const m=S(),o=E(()=>m.currentContest),r=E(()=>o.value?Object.keys(o.value.problems):[]),k=b([]),R=b(!1);function h(){o.value&&(R.value=!0,P({contest:o.value.id}).then(n=>{k.value=n.rankings,w()}).finally(()=>{R.value=!1}))}V(()=>{h()}),L(o,h);const y=b([]);function N(n,t){const u=n.results[t];return u?u.judge==="correct"?"solved":"attempted":""}function j(n){return n<=1?`${n} try`:`${n} tries`}function w(){if(o.value){y.value=[];for(const n of k.value){const t={rank:n.rank,user:n.user,totalPenalty:0,totalSolved:0,results:{}};for(const u of n.results)for(const e of r.value)if(o.value.problems[e]===u.problem){t.results[e]=u,u.judge==="correct"&&(t.totalPenalty+=u.penalty,t.totalSolved++);break}y.value.push(t)}}}return(n,t)=>{const u=I("router-link");return l(),a("div",z,[o.value?(l(),a("table",D,[s("colgroup",Q,[t[0]||(t[0]=s("col",{class:"col-rank"},null,-1)),t[1]||(t[1]=s("col",{class:"col-name"},null,-1)),t[2]||(t[2]=s("col",{class:"col-score-solved"},null,-1)),t[3]||(t[3]=s("col",{class:"col-score-penalty"},null,-1)),(l(!0),a(d,null,p(r.value,e=>(l(),a("col",G))),256))]),s("thead",null,[s("tr",H,[t[4]||(t[4]=s("th",{class:"rank"},"RANK",-1)),t[5]||(t[5]=s("th",{class:"name"},"TEAM",-1)),t[6]||(t[6]=s("th",{class:"score",colspan:"2"},"SCORE",-1)),(l(!0),a(d,null,p(r.value,e=>(l(),a("th",J,[f(u,{class:"problem",to:`/contest/${o.value.id}/problem/${o.value.problems[e]}`},{default:v(()=>[C(c(e),1)]),_:2},1032,["to"])]))),256))])]),s("tbody",null,[(l(!0),a(d,null,p(y.value,e=>(l(),a("tr",U,[s("td",W,c(e.rank),1),s("td",X,c(e.user),1),s("td",Y,c(e.totalSolved),1),s("td",Z,c(e.totalPenalty),1),(l(!0),a(d,null,p(r.value,i=>(l(),a("td",tt,[e.results[i]?(l(),a("div",{key:0,class:T(["result",N(e,i)])},[C(c(e.results[i].penalty)+" ",1),s("span",null,c(j(e.results[i].attempt)),1)],2)):O("",!0)]))),256))]))),256))])])):(l(),x(_(M),{key:1,description:"暂无排行"}))])}}}),et=B(st,[["__scopeId","data-v-f0978fa5"]]),lt={class:"button-container"},ot=$({__name:"ViewContestRanking",props:{cid_str:{}},setup(g){const m=g;return V(()=>{S().enter(parseInt(m.cid_str))}),(o,r)=>(l(),x(A,null,{default:v(()=>[s("div",lt,[f(_(K),{type:"primary",class:"back-button",onClick:r[0]||(r[0]=k=>_(F).push(`/contest/${o.cid_str}`))},{default:v(()=>r[1]||(r[1]=[C(" 返回比赛 ")])),_:1})]),f(_(q),{class:"ranklist-card"},{default:v(()=>[f(et)]),_:1})]),_:1}))}}),at=B(ot,[["__scopeId","data-v-f75e0a6a"]]);export{at as default};
