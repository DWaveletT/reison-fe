import{d as S,S as N,c as E,r as C,R as V,T as j,a as r,n as w,b as s,F as d,m as p,e as v,E as I,av as M,ad as P,p as l,i as f,q as m,v as g,t as c,l as A,$ as F,_ as x,ag as O,aw as q,L as z,N as D}from"./index-Byva4vat.js";const K={class:"ranklist-container"},G={key:0,class:"ranklist"},H={class:"colgroup"},J={class:"headline entry"},Q={class:"rank"},U={class:"name"},W={class:"score-solved"},X={class:"score-penalty"},Y=S({__name:"RankList",setup(b){const k=N(),n=E(()=>k.currentContest),a=E(()=>n.value?Object.keys(n.value.problems):[]),y=C([]),R=C(!1);function $(){n.value&&(R.value=!0,M({contest:n.value.id}).then(o=>{y.value=o.rankings,T()}).finally(()=>{R.value=!1}))}V(()=>{$()}),j(n,$);const _=C([]);function B(o,t){const u=o.results[t];return u?u.judge==="correct"?"solved":"attempted":""}function L(o){return o<=1?`${o} try`:`${o} tries`}function T(){if(n.value){_.value=[];for(const o of y.value){const t={rank:o.rank,user:o.user,totalPenalty:0,totalSolved:0,results:{}};for(const u of o.results)for(const e of a.value)if(n.value.problems[e]===u.problem){t.results[e]=u,u.judge==="correct"&&(t.totalPenalty+=u.penalty,t.totalSolved++);break}_.value.push(t)}}}return(o,t)=>{const u=P("router-link");return l(),r("div",K,[n.value?(l(),r("table",G,[s("colgroup",H,[t[0]||(t[0]=s("col",{class:"col-rank"},null,-1)),t[1]||(t[1]=s("col",{class:"col-name"},null,-1)),t[2]||(t[2]=s("col",{class:"col-score-solved"},null,-1)),t[3]||(t[3]=s("col",{class:"col-score-penalty"},null,-1)),(l(!0),r(d,null,p(a.value,e=>(l(),r("col",{class:"col-problem",key:e}))),128)),t[4]||(t[4]=s("col",{class:"col-empty"},null,-1))]),s("thead",null,[s("tr",J,[t[5]||(t[5]=s("th",{class:"rank"},"RANK",-1)),t[6]||(t[6]=s("th",{class:"name"},"TEAM",-1)),t[7]||(t[7]=s("th",{class:"score",colspan:"2"},"SCORE",-1)),(l(!0),r(d,null,p(a.value,e=>(l(),r("th",{class:"problem-cell",key:e},[f(u,{class:"problem",to:`/contest/${n.value.id}/problem/${n.value.problems[e]}`},{default:m(()=>[g(c(e),1)]),_:2},1032,["to"])]))),128)),t[8]||(t[8]=s("th",null,null,-1))])]),s("tbody",null,[(l(!0),r(d,null,p(_.value,e=>(l(),r("tr",{class:"normal-line entry",key:e.rank},[s("td",Q,c(e.rank),1),s("td",U,c(e.user),1),s("td",W,c(e.totalSolved),1),s("td",X,c(e.totalPenalty),1),(l(!0),r(d,null,p(a.value,i=>(l(),r("td",{class:"result-cell",key:i},[e.results[i]?(l(),r("div",{key:0,class:F(["result",B(e,i)])},[g(c(e.results[i].penalty)+" ",1),s("span",null,c(L(e.results[i].attempt)),1)],2)):A("",!0)]))),128)),t[9]||(t[9]=s("td",null,null,-1))]))),128))])])):(l(),w(v(I),{key:1,description:"暂无排行"}))])}}}),Z=x(Y,[["__scopeId","data-v-e720a747"]]),h={class:"button-container"},tt=S({__name:"ViewContestRanking",props:{cid_str:{}},setup(b){const k=b;return V(()=>{N().enter(parseInt(k.cid_str))}),(n,a)=>(l(),w(O,null,{default:m(()=>[s("div",h,[f(v(z),{type:"primary",class:"back-button",onClick:a[0]||(a[0]=y=>v(q).push(`/contest/${n.cid_str}`))},{default:m(()=>a[1]||(a[1]=[g(" 返回比赛 ")])),_:1})]),f(v(D),{class:"ranklist-card"},{default:m(()=>[f(Z)]),_:1})]),_:1}))}}),et=x(tt,[["__scopeId","data-v-112fec38"]]);export{et as default};
