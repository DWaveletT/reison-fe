import{d as S,R as x,c as E,r as b,S as V,T,e as r,a as j,f as s,F as p,l as f,b as v,n as I,ax as M,ad as O,p as l,k as m,w as k,v as g,t as c,j as P,$ as A,_ as w,aj as F,O as z,L as D,E as K}from"./index-mKRWm-IU.js";const q={class:"ranklist-container"},G={key:0,class:"ranklist"},H={class:"colgroup"},J={class:"headline entry"},Q={class:"rank"},U={class:"name"},W={class:"score-solved"},X={class:"score-penalty"},Y=S({__name:"RankList",setup(R){const y=x(),n=E(()=>y.currentContest),i=E(()=>n.value?Object.keys(n.value.problems):[]),u=b([]),_=b(!1);function $(){n.value&&(_.value=!0,M({contest:n.value.id}).then(o=>{u.value=o.rankings,N()}).finally(()=>{_.value=!1}))}V(()=>{$()}),T(n,$);const C=b([]);function B(o,t){const a=o.results[t];return a?a.judge==="correct"?"solved":"attempted":""}function L(o){return o<=1?`${o} try`:`${o} tries`}function N(){if(n.value){C.value=[];for(const o of u.value){const t={rank:o.rank,user:o.user,totalPenalty:0,totalSolved:0,results:{}};for(const a of o.results)for(const e of i.value)if(n.value.problems[e]===a.problem){t.results[e]=a,a.judge==="correct"&&(t.totalPenalty+=a.penalty,t.totalSolved++);break}C.value.push(t)}}}return(o,t)=>{const a=O("router-link");return l(),r("div",q,[n.value?(l(),r("table",G,[s("colgroup",H,[t[0]||(t[0]=s("col",{class:"col-rank"},null,-1)),t[1]||(t[1]=s("col",{class:"col-name"},null,-1)),t[2]||(t[2]=s("col",{class:"col-score-solved"},null,-1)),t[3]||(t[3]=s("col",{class:"col-score-penalty"},null,-1)),(l(!0),r(p,null,f(i.value,e=>(l(),r("col",{class:"col-problem",key:e}))),128)),t[4]||(t[4]=s("col",{class:"col-empty"},null,-1))]),s("thead",null,[s("tr",J,[t[5]||(t[5]=s("th",{class:"rank"},"RANK",-1)),t[6]||(t[6]=s("th",{class:"name"},"TEAM",-1)),t[7]||(t[7]=s("th",{class:"score",colspan:"2"},"SCORE",-1)),(l(!0),r(p,null,f(i.value,e=>(l(),r("th",{class:"problem-cell",key:e},[m(a,{class:"problem",to:`/contest/${n.value.id}/problem/${n.value.problems[e]}`},{default:k(()=>[g(c(e),1)]),_:2},1032,["to"])]))),128)),t[8]||(t[8]=s("th",null,null,-1))])]),s("tbody",null,[(l(!0),r(p,null,f(C.value,e=>(l(),r("tr",{class:"normal-line entry",key:e.rank},[s("td",Q,c(e.rank),1),s("td",U,c(e.user),1),s("td",W,c(e.totalSolved),1),s("td",X,c(e.totalPenalty),1),(l(!0),r(p,null,f(i.value,d=>(l(),r("td",{class:"result-cell",key:d},[e.results[d]?(l(),r("div",{key:0,class:A(["result",B(e,d)])},[g(c(e.results[d].penalty)+" ",1),s("span",null,c(L(e.results[d].attempt)),1)],2)):P("",!0)]))),128)),t[9]||(t[9]=s("td",null,null,-1))]))),128))])])):(l(),j(v(I),{key:1,description:"暂无排行"}))])}}}),Z=w(Y,[["__scopeId","data-v-e720a747"]]),h={class:"button-container"},tt=S({__name:"ViewContestRanking",props:{cid_str:{}},setup(R){const y=z(),n=R;return V(()=>{x().enter(parseInt(n.cid_str))}),(i,u)=>(l(),j(F,null,{default:k(()=>[s("div",h,[m(v(D),{type:"primary",class:"back-button",onClick:u[0]||(u[0]=_=>v(y).push(`/contest/${i.cid_str}`))},{default:k(()=>u[1]||(u[1]=[g(" 返回比赛 ")])),_:1})]),m(v(K),{class:"ranklist-card"},{default:k(()=>[m(Z)]),_:1})]),_:1}))}}),et=w(tt,[["__scopeId","data-v-199b4f70"]]);export{et as default};
